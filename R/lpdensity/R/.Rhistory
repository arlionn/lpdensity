Ggenerate <- function(p, low=-1, up=1, kernel="triangular") {
G <- matrix(rep(0, (p+1)^2), ncol=(p+1))
for (i in 1:(p+1)) {
for (j in 1:(p+1)) {
if (kernel == "uniform") {
G[i,j] <- integrate(function(y) {
sapply(y, function(y) {
integrate(function(x) x^i * y^(j-1)*0.25, low, y)$value
})
}, low, up)$value +
integrate(function(y) {
sapply(y, function(y) {
integrate(function(x) x^(i-1) * y^j*0.25, y, up)$value
})
}, low, up)$value
} else if (kernel == "epanechnikov") {
G[i,j] <- integrate(function(y) {
sapply(y, function(y) {
integrate(function(x) x^i * y^(j-1) * 0.75^2 *
(1-x^2) * (1-y^2), low, y)$value
})
}, low, up)$value +
integrate(function(y) {
sapply(y, function(y) {
integrate(function(x) x^(i-1) * y^j * 0.75^2 *
(1-x^2) * (1-y^2), y, up)$value
})
}, low, up)$value
} else {
G[i,j] <- integrate(function(y) {
sapply(y, function(y) {
integrate(function(x) x^i * y^(j-1) *
(1-abs(x)) * (1-abs(y)), low, y)$value
})
}, low, up)$value +
integrate(function(y) {
sapply(y, function(y) {
integrate(function(x) x^(i-1) * y^j *
(1-abs(x)) * (1-abs(y)), y, up)$value
})
}, low, up)$value
}
}
}
return(G)
}
Ggenerate(2)
Ggenerate(2, kernel="Uniform")
Ggenerate(p=2, kernel="uniform")
Ggenerate(p=2, kernel="triangular")
7/30
67/1260
Ggenerate(p=2, lower=0, kernel="triangular")
Ggenerate(p=2, low=0, kernel="triangular")
31/2520
